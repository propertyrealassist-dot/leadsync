<!DOCTYPE html>
<html>
<head>
    <title>Test GHL OAuth URL</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1f3a;
            color: white;
        }
        .test-box {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }
        button {
            background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            opacity: 0.9;
        }
        .url-display {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            word-break: break-all;
            font-family: monospace;
            font-size: 12px;
            margin: 10px 0;
        }
        .success { color: #10b981; }
        .error { color: #ef4444; }
    </style>
</head>
<body>
    <h1>üß™ GHL OAuth URL Test</h1>

    <div class="test-box">
        <h2>Your OAuth URL:</h2>
        <div class="url-display" id="urlDisplay"></div>

        <h3>Actions:</h3>
        <button onclick="testRedirect()">üöÄ Test Redirect (Opens GHL)</button>
        <button onclick="copyUrl()">üìã Copy URL</button>
        <button onclick="validateUrl()">‚úÖ Validate URL</button>
    </div>

    <div class="test-box" id="results">
        <h3>Validation Results:</h3>
        <div id="output"></div>
    </div>

    <script>
        const GHL_OAUTH_URL =
            'https://marketplace.gohighlevel.com/oauth/chooselocation?' +
            'response_type=code&' +
            'redirect_uri=https%3A%2F%2Fapi.realassistagents.com%2Fapi%2Foauth%2Fredirect&' +
            'client_id=69218dacd101d3222ff1708c-mic4vq7j&' +
            'scope=contacts.readonly+contacts.write+conversations.readonly+conversations.write+' +
            'calendars%2Fevents.readonly+calendars%2Fevents.write+opportunities.readonly+' +
            'opportunities.write+locations.readonly&' +
            'version_id=69218dacd101d3222ff1708c';

        document.getElementById('urlDisplay').textContent = GHL_OAUTH_URL;

        function testRedirect() {
            console.log('Redirecting to:', GHL_OAUTH_URL);
            window.location.href = GHL_OAUTH_URL;
        }

        function copyUrl() {
            navigator.clipboard.writeText(GHL_OAUTH_URL);
            alert('‚úÖ URL copied to clipboard!');
        }

        function validateUrl() {
            const output = document.getElementById('output');
            let html = '';

            const url = new URL(GHL_OAUTH_URL);

            // Check base URL
            html += `<p class="${url.hostname === 'marketplace.gohighlevel.com' ? 'success' : 'error'}">`;
            html += `‚úì Base URL: ${url.hostname}</p>`;

            // Check parameters
            const params = new URLSearchParams(url.search);

            const checks = [
                { name: 'response_type', expected: 'code' },
                { name: 'client_id', expected: '69218dacd101d3222ff1708c-mic4vq7j' },
                { name: 'version_id', expected: '69218dacd101d3222ff1708c' },
                { name: 'redirect_uri', contains: 'api.realassistagents.com' }
            ];

            checks.forEach(check => {
                const value = params.get(check.name);
                const isValid = check.expected
                    ? value === check.expected
                    : value && value.includes(check.contains);

                html += `<p class="${isValid ? 'success' : 'error'}">`;
                html += isValid ? '‚úÖ' : '‚ùå';
                html += ` ${check.name}: ${value}</p>`;
            });

            // Check scope
            const scope = params.get('scope');
            const requiredScopes = [
                'contacts.readonly',
                'contacts.write',
                'conversations.readonly',
                'calendars/events.readonly'
            ];

            html += '<h4>Scopes:</h4>';
            requiredScopes.forEach(s => {
                const hasScope = scope && scope.includes(s);
                html += `<p class="${hasScope ? 'success' : 'error'}">`;
                html += hasScope ? '‚úÖ' : '‚ùå';
                html += ` ${s}</p>`;
            });

            output.innerHTML = html;
        }

        // Auto-validate on load
        validateUrl();
    </script>
</body>
</html>
